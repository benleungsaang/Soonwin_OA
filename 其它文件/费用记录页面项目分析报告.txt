  最终费用记录页面项目分析报告

  1. 需求概要
  费用记录页面将用于管理员创建和管理全面分摊费用，费用将按订单金额比例分摊到指定年度的所有订单中。

  2. 功能设计（最终版）
   - 基础字段：名称、费用（正负值）、分摊类型（全面分摊）、年份选择、备注
   - 分摊类型：仅"全面分摊"，按订单金额比例分摊到指定年度的所有订单
   - 权限控制：仅管理员可访问费用记录页面
   - 订单特定费用：在订单管理页面单独处理

  3. 计算逻辑
   - 订单毛利 = 订单总金额 - 订单中记录的物料成本
   - 订单净利 = 订单总金额 - 订单中记录的物料成本 - 总体分摊费用 - 针对订单的特定费用
   - 毛利率 = 毛利 / 总金额
   - 净利率 = 净利 / 总金额

  4. 数据存储策略
   - 费用分摊结果预计算并存储到数据库中
   - 每次创建/修改费用后自动更新分摊数据
   - 订单管理页面上方显示当前统计的全面分摊费用及统计时间
   - 提供"更新数据"按钮，允许用户手动触发重新分摊计算

  5. 页面功能
   - 费用记录页面：增删改查基础功能 + 搜索筛选
   - 统计图表：按需计算并更新（点击后计算），显示订单总金额、毛利、净利的饼图
   - 订单管理页面：显示当前全面分摊费用及统计时间，并提供更新按钮

  6. 技术实现建议
   - 前端：使用Vue + Element Plus实现费用记录页面和订单管理页面的费用显示
   - 后端：创建费用模型和费用分摊结果表
   - 实现费用创建/修改时的自动分摊计算机制
   - 实现手动更新分摊数据的API

  7. 后续功能规划
   - 在订单管理页面添加针对特定订单的费用添加功能
   - 订单管理页面为业务员展示部分列

✦ 这个方案完美平衡了性能和用户体验，用户可以控制数据更新时机，同时保证了订单页面的加载速度。